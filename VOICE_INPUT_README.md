# 语音输入功能说明

## 功能概述

聊天界面新增了语音输入功能，用户可以通过语音输入文字，然后调用现有的聊天接口。

## 使用方法

### 桌面端
1. **启动语音输入**：长按输入框右侧的麦克风图标（长按200ms）
2. **开始录音**：长按后图标变为橙色并开始闪烁，表示正在录音
3. **停止录音**：松开按钮停止录音

### 移动端
1. **启动语音输入**：点击输入框右侧的麦克风图标
2. **开始录音**：点击后图标变为橙色并开始闪烁，表示正在录音
3. **停止录音**：再次点击按钮停止录音

### 通用
4. **自动识别**：语音识别完成后，识别的文字会自动填入输入框
5. **手动发送**：点击发送按钮或按回车键发送消息

### 操作提示
- **桌面端长按中**：按钮变为蓝色，显示"准备录音..."
- **录音中**：按钮变为橙色并闪烁，显示"正在录音..."
- **桌面端松开停止**：松开按钮立即停止录音
- **移动端点击切换**：点击按钮切换录音状态

## 技术实现

- **Web Speech API**：使用浏览器的原生语音识别功能
- **桌面端长按触发**：长按200ms后开始录音，松开立即停止
- **移动端单击触发**：单击开始录音，再次单击停止录音
- **语言设置**：默认设置为中文（zh-CN）
- **错误处理**：包含完整的错误提示和处理机制
- **移动端优化**：适配移动设备的触摸操作
- **视觉反馈**：按钮大小、颜色、缩放动画提供直观反馈

## 浏览器兼容性

- ✅ Chrome/Edge（推荐）
- ✅ Safari（部分支持）
- ❌ Firefox（不支持）
- ❌ 旧版浏览器

## 注意事项

1. **HTTPS要求**：语音识别功能需要HTTPS环境（localhost除外）
2. **麦克风权限**：首次使用需要授权麦克风访问权限
3. **网络连接**：语音识别需要网络连接
4. **环境噪音**：建议在安静环境中使用以获得更好的识别效果

## 错误处理

- **浏览器不支持**：显示灰色禁用状态的麦克风图标
- **权限被拒绝**：显示相应的错误提示
- **网络错误**：显示网络连接错误信息
- **识别失败**：显示识别失败的具体原因
- **aborted错误**：正常的中断行为，不会显示错误提示

## 移动端特性

- 响应式设计，适配不同屏幕尺寸
- 大尺寸按钮（移动端48px，桌面端56px）
- 长按触发机制，适合移动设备操作
- 优化的提示信息显示
- 支持触摸操作反馈
- 按钮缩放动画提供触觉反馈

## 开发说明

语音输入组件位于 `components/Chat/VoiceInput.tsx`，已集成到 `ChatInput.tsx` 中。

TypeScript类型声明位于 `types/speech.d.ts`。
